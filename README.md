# Code for grid cell analysis

For replicating specific figures from the paper, please see scripts in OverallAnalysis. Details on which script is needed for which figure are in: Gerlei_et_at_2020_where_to_find_data_and_code.xlsx (also copied below for convenience)

The grid cell data is available from: https://datashare.is.ed.ac.uk/handle/10283/3674

-------------------------------------------------------------------------------------------------------------------------

To use the code for analyzing spatial cells such as head direction cells and grid cells, see scripts in PostSorting.
See some examples of using PostSorting here:
https://github.com/MattNolanLab/grid_cell_analysis/blob/master/example_spatial_analysis.py

There is more detailed documentation on how the code is organized and what the main data frames contain:
https://github.com/MattNolanLab/grid_cell_analysis/wiki/Content-of-data-frame-columns


Please don't hesitate to submit an issue if there's a problem.


![grid_cells](https://user-images.githubusercontent.com/16649631/85288620-ef83c480-b48d-11ea-9904-d9dacfb3c110.jpg)


-------------------------------------------------------------------------------------------------------------------------

|                           | Basic info                                                                                                                             | Data file / folder name(s) or identifier(s) (add accession number, DOI or web link to data where applicable) | Data file format(s) and file type                     | Location of data file(s) or repository name    | Script(s) used                                                            |
|---------------------------|----------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|------------------------------------------------|---------------------------------------------------------------------------|
| Data supporting figures   |                                                                                                                                        |                                                                                                              |                                                       |                                                |                                                                           |
| Data supporting figure 1a | Simulated data to explain hypothesis                                                                                                   | /prediction_schematics                                                                                       | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | model_prediction_schematics_simulated.py                                  |
| Data supporting figure 1b | data from example cells from M12_2018-04-10_14-22-14_of (mouse data) and 11025-01060511 (Sargolini et al)                              | Spike sorting pipeline output                                                                                | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | (control_sorting_analysis.py)                                             |
| Data supporting figure 1c | Watson test results (grid cells only)                                                                                                  | /watson_two_test_cells                                                                                       | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | analyze_hd_from_whole_session.py                                          |
| Data supporting figure 1d | Watson test results (all cells)                                                                                                        | /watson_two_test_cells                                                                                       | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | analyze_hd_from_whole_session.py                                          |
| Data supporting figure 2b | Shuffled analysis example cell                                                                                                         | /methods_directional_cell                                                                                    | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | directional_cell_definition_example_figure.py                             |
| Data supporting figure 2c | Shuffled analysis for all grid cells                                                                                                   | /shuffled_analysis_cell                                                                                      | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | shuffle_cell_analysis.py                                                  |
| Data supporting figure 3a | Firing rate map for M12_2018-04-10_14-22-14_of (mouse data)                                                                            | Spike sorting pipeline output                                                                                | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | (control_sorting_analysis.py)                                             |
| Data supporting figure 3b | Shuffled analysis for fields example                                                                                                   | /shuffled_analysis/percentile and in  M12_2018-04-10_14-22-14_of folder                                      | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | shuffle_field_analysis.py and shuffle_field_analysis_all_animals.py       |
| Data supporting figure 3c | Shuffled analysis for fields example                                                                                                   | /plot_hd_tuning_vs_shuffled_fields/example_mouse_distributive                                                | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | plot_hd_tuning_vs_shuffled_fields.py                                      |
| Data supporting figure 3d | Shuffled analysis for all grid fields                                                                                                  | /shuffled_analysis                                                                                           | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | shuffle_field_analysis_all_animals.py                                     |
| Data supporting figure 4a | Comparison of classic head direction plots of fields                                                                                   | /field_histogram_shapes                                                                                      | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | compare_shape_of_fields.py                                                |
| Data supporting figure 4b | Comparison of classic head direction plots of fields                                                                                   | /field_histogram_shapes                                                                                      | pandas (.pkl) data frames, csv files (for the R code) | https://datashare.is.ed.ac.uk/handle/10283/777 | Correlation.Rmd                                                           |
| Data supporting figure 4c | Comparison of fields from half sessions                                                                                                | /field_histogram_shapes                                                                                      | csv files                                             | https://datashare.is.ed.ac.uk/handle/10283/777 | RecordingDurations.Rmd                                                    |
| Data supporting figure 4d | Comparison of classic head direction plots of fields for centre and border fields                                                      | /field_histogram_shapes                                                                                      | csv files                                             | https://datashare.is.ed.ac.uk/handle/10283/777 | Correlation.Rmd                                                           |
| Data supporting figure 5a | Firing rate map for M13_2018 05 14 (mouse data)                                                                                        | Spike sorting pipeline output                                                                                | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | (control_sorting_analysis.py)                                             |
| Data supporting figure 5b | Head direction plots from first and second half of session from M13 2018 05 14 (mouse data)                                            | /watson_two_test_cells                                                                                       | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | plot_example_polar_hists_first_and_second_half.py                         |
| Data supporting figure 5c | Comparison of head direction from first and second half for whole session                                                              | /correlation_cell                                                                                            | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | compare_first_and_second_half_cell.py                                     |
| Data supporting figure 5d | Distributive head direction plots from first and second half of sesssion                                                               | /plot_hd_tuning_vs_shuffled                                                                                  | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | plot_hd_tuning_vs_shuffled.py                                             |
| Data supporting figure 5e | Firing rate map with detected fields for M13_2018 05 14 (mouse data)                                                                   | Spike sorting pipeline output                                                                                | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | (control_sorting_analysis.py)                                             |
| Data supporting figure 5f | Classic head direction plots for half fields                                                                                           | /first_vs_second_fields                                                                                      | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | compare_shape_of_fields.py                                                |
| Data supporting figure 5g | Comparison of head direction from first and second half for fields                                                                     | /field_histogram_shapes                                                                                      | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | compare_shape_of_fields.py                                                |
| Data supporting figure 5h | Distributive head direction plots from first and second half of sesssion for example field                                             | /plot_hd_tuning_vs_shuffled_fields                                                                           | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | plot_hd_tuning_vs_shuffled_fields.py                                      |
| Data supporting figure 6a | Grid cell simulation results for Burgess model                                                                                         | /grid_cell_models/pastoll                                                                                    | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | (control_sorting_analysis.py)                                             |
| Data supporting figure 6b | Grid cell simulation results for Pastoll model                                                                                         | /grid_cell_models/burgess                                                                                    | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | (control_sorting_analysis.py)                                             |
| Data supporting figure 6c | Comparison of number of significant bins (between models and experimental data)                                                        | /simulation_comparisons                                                                                      | csv files                                             | https://datashare.is.ed.ac.uk/handle/10283/777 | 6cd.R                                                                     |
| Data supporting figure 6d | Comparison of proportion of directional fields (between models and experimental data)                                                  | /simulation_comparisons                                                                                      | csv files                                             | https://datashare.is.ed.ac.uk/handle/10283/777 | 6cd.R                                                                     |
| Data supporting figure 7a | Simulated input conjunctive cells                                                                                                      | /grid_cell_models/gerlei_nonuniform                                                                          | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | grid_run.py                                                               |
| Data supporting figure 7b | Representative ratemap for non-uniform model                                                                                           | /grid_cell_models/gerlei_nonuniform                                                                          | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | grid_run.py, analyze_simulated_grid_cells.py, control_sorting_analysis.py |
| Data supporting figure 7c | Representative firing fields for non-uniform model                                                                                     | /grid_cell_models/gerlei_nonuniform                                                                          | pandas (.pkl) data frames                             | https://datashare.is.ed.ac.uk/handle/10283/777 | grid_run.py, analyze_simulated_grid_cells.py, control_sorting_analysis.py |
| Data supporting figure 7d | Comparisons of significant bins per field & proportion of direction fields between conjunctive cell input models and experimental data | /simulation_comparisons                                                                                      | csv files                                             | https://datashare.is.ed.ac.uk/handle/10283/777 | 7d.R                                                                      |
| Data supporting figure 8a | Schematic showing input cells to uniform and non-uniform conjunctive models                                                            |                                                                                                              |                                                       |                                                |                                                                           |
| Data supporting figure 8b | Comparison of classic head direction plots of fields                                                                                   | /field_histogram_shapes                                                                                      | pandas (.pkl) data frames, csv files (for the R code) | https://datashare.is.ed.ac.uk/handle/10283/777 | Correlation.Rmd                                                           |
| Data supporting figure 8c | Comparison of fields from half sessions                                                                                                | /field_histogram_shapes                                                                                      | csv files                                             | https://datashare.is.ed.ac.uk/handle/10283/777 | RecordingDurations.Rmd                                                    |
